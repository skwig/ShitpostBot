###############################################################################
# End-to-End Test Suite for ShitpostBot Repost Detection
###############################################################################
#
# PURPOSE:
#   Master test file that orchestrates all E2E test scenarios for validating
#   the ShitpostBot's image repost detection functionality end-to-end.
#
# USAGE:
#   - Run via automated script: ./test/e2e/run-e2e-tests.sh (from repo root)
#   - Manual execution: ijhttp --no-progress test/e2e/e2e-tests.http
#
# REQUIREMENTS:
#   - Services must be running (use run-e2e-tests.sh or docker compose)
#   - ijhttp CLI tool (available via Nix flake)
#
# TEST SCENARIOS:
#   1. Posting unrelated images (should NOT trigger repost detection)
#   2. Reposting downscaled images (should trigger repost detection)
#   3. Reposting in different formats (should trigger repost detection)
#   4. Bot command execution (should send message with expected content)
#   5. Semantic search (should find images using natural language queries)
#
# ASSERTIONS:
#   Each scenario uses JavaScript assertions to verify:
#   - HTTP status codes (200 OK)
#   - Response structure (messageId present)
#   - Bot actions (correct reactions in correct order)
#
# NOTES:
#   - Uses JetBrains HTTP Client format with JavaScript test blocks
#   - Variables passed between requests via client.global.set/get
#   - All scenarios validate machine-assertable bot actions via /test/actions
#
###############################################################################

@host = http://localhost:8080

### Scenario 1
run scenarios/scenario-1-posting-unrelated-images-and-asking-bot.http(@host={{host}})

### Scenario 2
run scenarios/scenario-2-reposting-downscaled.http(@host={{host}})

### Scenario 3
run scenarios/scenario-3-reposting-in-different-formats.http(@host={{host}})

### Scenario 4
run scenarios/scenario-4-bot-command-about.http(@host={{host}})

### Scenario 5
run scenarios/scenario-5-semantic-search.http(@host={{host}})
